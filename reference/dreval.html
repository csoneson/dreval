<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Evaluate structure preservation in reduced dimension representations — dreval • dreval</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluate structure preservation in reduced dimension representations — dreval"><meta property="og:description" content="Calculates a collection of metrics comparing one or more reduced dimension
representations to a reference representation. The function takes a
SingleCellExperiment object as input. The reference representation can
be either one of the included assays or one of the reduced dimension
representations. If an assay is used, reference distances can be calculated
based on all or a subset of the features (rows). These distances are then
compared to distances calculated from the specified reduced dimension
representations, and several scores are returned. The execution time of the
function depends strongly on both the number of retained variables (which
affects the distance calculation in the reference space) and the number of
samples that are randomly selected to use as the basis for the comparison.
Since subsampling of the columns (via the nSamples argument) is
random, setting the random seed is recommended to obtain reproducible
results."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dreval</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dreval.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/dreval.html">dreval</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/csoneson/dreval" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate structure preservation in reduced dimension representations</h1>
    <small class="dont-index">Source: <a href="https://github.com/csoneson/dreval/blob/HEAD/R/dreval.R" class="external-link"><code>R/dreval.R</code></a></small>
    <div class="hidden name"><code>dreval.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates a collection of metrics comparing one or more reduced dimension
representations to a reference representation. The function takes a
<code>SingleCellExperiment</code> object as input. The reference representation can
be either one of the included assays or one of the reduced dimension
representations. If an assay is used, reference distances can be calculated
based on all or a subset of the features (rows). These distances are then
compared to distances calculated from the specified reduced dimension
representations, and several scores are returned. The execution time of the
function depends strongly on both the number of retained variables (which
affects the distance calculation in the reference space) and the number of
samples that are randomly selected to use as the basis for the comparison.
Since subsampling of the columns (via the <code>nSamples</code> argument) is
random, setting the random seed is recommended to obtain reproducible
results.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">dreval</span><span class="op">(</span>
  <span class="va">sce</span>,
  dimReds <span class="op">=</span> <span class="cn">NULL</span>,
  refType <span class="op">=</span> <span class="st">"assay"</span>,
  refAssay <span class="op">=</span> <span class="st">"logcounts"</span>,
  refDimRed <span class="op">=</span> <span class="cn">NULL</span>,
  features <span class="op">=</span> <span class="cn">NULL</span>,
  nSamples <span class="op">=</span> <span class="cn">NULL</span>,
  distNorm <span class="op">=</span> <span class="st">"none"</span>,
  refDistMethod <span class="op">=</span> <span class="st">"euclidean"</span>,
  kTM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>,
  labelColumn <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sce</dt>
<dd><p>A <code>SingleCellExperiment</code> object.</p></dd>
<dt>dimReds</dt>
<dd><p>A character vector with the names of the reduced dimension
representations from <code>sce</code> to include in the evaluation. If
<code>NULL</code>, all reduced dimension representations are included.</p></dd>
<dt>refType</dt>
<dd><p>A character scalar, either "assay" or "dimred", specifying
whether to use an assay or a reduced dimension representation of <code>sce</code>
as the reference data source.</p></dd>
<dt>refAssay</dt>
<dd><p>A character scalar giving the name of the assay from
<code>sce</code> to use as the basis for the distance calculations in the
reference space, if <code>refType</code> if <code>"assay"</code>.</p></dd>
<dt>refDimRed</dt>
<dd><p>A character scalar specifying the reduced dimension
representation to use as the reference data representation if
<code>refType</code> is <code>"dimred"</code>.</p></dd>
<dt>features</dt>
<dd><p>A character vector giving the IDs of the features to use for
distance calculations from the chosen assay. Will be matched to the row
names of <code>sce</code>.</p></dd>
<dt>nSamples</dt>
<dd><p>A numeric scalar, giving the number of columns to subsample
(randomly) from <code>sce</code>.</p></dd>
<dt>distNorm</dt>
<dd><p>A character scalar, indicating how the distance vectors in
the reference and low-dimensional spaces should be normalized before they
are compared. If set to "l2", the vectors are L2 normalized, if set to
"median" they are divided by the median value times the square root of
their length, and if set to any other value they are divided by the square
root of their length, to avoid metrics scaling with the number of retained
samples.</p></dd>
<dt>refDistMethod</dt>
<dd><p>A character scalar defining the distance measure to use
in the reference space. Must be one of "euclidean", "manhattan", "maximum",
"canberra" or "cosine". The distance in the low-dimensional representation
will always be Euclidean.</p></dd>
<dt>kTM</dt>
<dd><p>An integer vector giving the number of neighbors to use for
trustworthiness, continuity and Jaccard index calculations.</p></dd>
<dt>labelColumn</dt>
<dd><p>A character scalar defining a column of
<code>colData(sce)</code> to use as the group assignments in the silhouette width
calculations. If not provided, the silhouette widths are not calculated.</p></dd>
<dt>verbose</dt>
<dd><p>A logical scalar, indicating whether to print out progress
messages.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with two elements:</p><ul><li><p>scores - A <code>data.frame</code> with values of all evaluation metrics,
across the dimension reduction methods. In addition to the metrics, it
contains the dimensionality of the respective reduced dimension
representations, and the value of K giving the highest value of LCMC (used
for the calculations of Qlocal and Qglobal, see Kraemer et al 2018, Lee and
Verleysen 2009, Chen and Buja 2009).</p></li>
<li><p>plots - A list of ggplot objects, representing diagnostic plots.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The following metrics are calculated:</p><ul><li><p>SpearmanCorrDist - The Spearman correlation between the reference
  distances and the Euclidean distances in the low-dimensional
  representation. Ranges from -1 to 1, higher values are better.</p></li>
<li><p>PearsonCorrDist - The Pearson correlation between the reference
  distances and the Euclidean distances in the low-dimensional
  representation. Ranges from -1 to 1, higher values are better.</p></li>
<li><p>KSstatDist - The Kolmogorov-Smirnov statistic comparing the
  distribution of distances in the reference space and in the low-dimensional
  representation. Ranges from 0 to 1, lower values are better.</p></li>
<li><p>EuclDistBetweenDists - The Euclidean distance between the vector of
  distances in the reference space and those in the low-dimensional
  representation. Depending on the value of <code>distNorm</code>, distances are
  scaled before they are compared. Lower values are better.</p></li>
<li><p>SammonStress - The Sammon stress (Sammon 1969). Depending on the
  value of <code>distNorm</code>, distances are scaled before they are compared.
  Lower values are better.</p></li>
<li><p>Trustworthiness_kNN - The trustworthiness score (Venna &amp; Kaski 2001),
  using NN nearest neighbors. The trustworthiness indicates to which degree
  we can trust that the points placed closest to a given sample in the
  low-dimensional representation are really close to the sample also in the
  reference space. Ranges from 0 to 1, higher values are better.</p></li>
<li><p>Continuity_kNN - The continuity score (Venna &amp; Kaski 2001), using NN
  nearest neighbors. The continuity indicates to which degree we can trust
  that the points closest to a given sample in the reference space are placed
  close to the sample also in the low-dimensional representation. Ranges from
  0 to 1, higher values are better.</p></li>
<li><p>MeanJaccard_kNN - The mean Jaccard index (over all samples),
  comparing the set of NN nearest neighbors in the reference space and those
  in the low-dimensional representation. Ranges from 0 to 1, higher values
  are better.</p></li>
<li><p>MeanSilhouette_X - If a <code>labelColumn</code> X is supplied, the mean
  silhouette score (Rousseeuw 1987) across all samples, with the grouping
  given by this column and the distances obtained from the low-dimensional
  representation. Ranges from -1 to 1, higher values are better.</p></li>
<li><p>coRankingQlocal - Q_local, defined as the average LCMC over the
  values to the left of the maximum, following the dimRed/coRanking package
  implementations (Kraemer et al 2018, Lee and Verleysen 2009, Chen and Buja
  2009). Measures the preservation of local distances, higher values are
  better.</p></li>
<li><p>coRankingQglobal - Q_global, defined as the average LCMC over the
  values to the right of the maximum, following the dimRed/coRanking package
  implementations (Kraemer et al 2018, Lee and Verleysen 2009, Chen and Buja
  2009). Measures the preservation of global distances, higher values are
  better.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Venna J., Kaski S. (2001). Neighborhood preservation in nonlinear
  projection methods: An experimental study. In Dorffner G., Bischof H.,
  Hornik K., editors, Proceedings of ICANN 2001, pp 485–491. Springer,
  Berlin.</p>
<p>Lee J.A., Verleysen M. (2009). Quality assessment of
  dimensionality reduction: Rank-based criteria. Neurocomputing 72
  (7-9):1431-1443.</p>
<p>Chen L., Buja A. (2009). Local multidimensional scaling for nonlinear
  dimension reduction, graph drawing, and proximity analysis. Journal of the
  American Statistical Association 104:209-219.</p>
<p>Kraemer G., Reichstein M., Mahecha M.D. (2018). dimRed and coRanking -
  Unifying dimensionality reduction in R. The R Journal 10 (1):342-358.</p>
<p>Sammon J.W. Jr (1969). A nonlinear mapping for data structure analysis.
  IEEE Transactions on Computers C18(5):401-409.</p>
<p>Rousseeuw, P.J. (1987). Silhouettes: A graphical aid to the interpretation
  and validation of cluster analysis. Journal of Computational and Applied
  Mathematics 20:53-65.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbmc3ksub</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dre</span> <span class="op">&lt;-</span> <span class="fu">dreval</span><span class="op">(</span>sce <span class="op">=</span> <span class="va">pbmc3ksub</span>, nSamples <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://csoneson.github.io" class="external-link">Charlotte Soneson</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>dreval â€¢ dreval</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="dreval">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dreval</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dreval.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dreval.html">dreval</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/csoneson/dreval">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>dreval</h1>
                        <h4 class="author">Charlotte Soneson</h4>
            
            <h4 class="date">2019-10-11</h4>
      
      
      <div class="hidden name"><code>dreval.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dreval)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The primary aim of the <code>dreval</code> package is to evaluate and compare one or more reduced dimension representations, in terms of how well they retain the structure from a reference representation. Here, we illustrate its application to a single-cell RNA-seq data set of peripheral blood mononuclear cells (PBMCs), representing a subset of the <code>pbmc3k</code> data set from the <code>TENxPBMCData</code> package. The set of genes has been subset to only highly variable ones, and several dimension reduction methods (PCA, tSNE and UMAP) have been applied.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(pbmc3ksub)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">pbmc3ksub</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; class: SingleCellExperiment </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; dim: 1804 2700 </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; metadata(1): log.exprs.offset</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; assays(2): counts logcounts</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; rownames(1804): LYZ S100A9 ... AGTRAP ATXN1L</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; rowData names(3): ENSEMBL_ID Symbol_TENx Symbol</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; colnames(2700): Cell1 Cell2 ... Cell2699 Cell2700</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; colData names(11): Sample Barcode ... Individual Date_published</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; reducedDimNames(8): PCA PCA_k2 ... UMAP_nn15 UMAP_nn30</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; spikeNames(0):</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; altExpNames(0):</span></a></code></pre></div>
</div>
<div id="evaluation" class="section level1">
<h1 class="hasAnchor">
<a href="#evaluation" class="anchor"></a>Evaluation</h1>
<p>The <code><a href="../reference/dreval.html">dreval()</a></code> function is the main function in the package, and calculates several metrics comparing each of the reduced dimension representations in the <code>SingleCellExperiment</code> object to the designed reference representation. Here, we use the underlying normalized and log-transformed data contained in the <code>logcounts</code> assay as the reference representation. For a list of the calculated metrics, see the help page for <code><a href="../reference/dreval.html">dreval()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">dre &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dreval.html">dreval</a></span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="dt">sce =</span> pbmc3ksub, <span class="dt">refType =</span> <span class="st">"assay"</span>, <span class="dt">refAssay =</span> <span class="st">"logcounts"</span>, </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="dt">dimReds =</span> <span class="ot">NULL</span>, <span class="dt">nSamples =</span> <span class="dv">500</span>, <span class="dt">kTM =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">10</span>, <span class="dv">75</span>), </a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">distNorm =</span> <span class="st">"l2"</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">)</a></code></pre></div>
</div>
<div id="result-visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#result-visualization" class="anchor"></a>Result visualization</h1>
<p>The output of <code><a href="../reference/dreval.html">dreval()</a></code> is a list with two elements. The <code>plots</code> entry contains several diagnostic plot objects, while the <code>scores</code> entry contains the calculated scores for each of the evaluated reduced dimension representations. These can be summarized visually with the <code><a href="../reference/plotRankSummary.html">plotRankSummary()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">dre<span class="op">$</span>scores</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;         Method dimensionality SpearmanCorrDist PearsonCorrDist KSStatDist</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; 1          PCA             25        0.8170169       0.8303285  0.3350060</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; 2       PCA_k2              2        0.6999102       0.6784489  0.4815631</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 3  TSNE_perp30              2        0.6638731       0.6146648  0.3768898</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 4   TSNE_perp5              2        0.4164520       0.3835101  0.3911663</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 5  TSNE_perp15              2        0.6029827       0.5744231  0.3812024</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; 6 TSNE_perp100              2        0.6515961       0.5962751  0.3823407</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; 7    UMAP_nn15              2        0.6140193       0.5837915  0.4254028</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 8    UMAP_nn30              2        0.6278549       0.5652291  0.4555591</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;   EuclDistBetweenDists SammonStress Trustworthiness_k10 Continuity_k10</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; 1            0.2573062    0.0692519           0.9270646      0.9247265</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; 2            0.4992759    0.2632985           0.8348693      0.8781866</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; 3            0.3978984    0.1664798           0.8699988      0.8847562</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 4            0.4104967    0.1734871           0.8522147      0.8395472</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; 5            0.3961406    0.1646422           0.8674902      0.8734704</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; 6            0.4465687    0.2113615           0.8771307      0.8832784</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; 7            0.5234025    0.2936086           0.8590716      0.8819307</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; 8            0.5629662    0.3382472           0.8581007      0.8826089</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;   Trustworthiness_k75 Continuity_k75 MeanJaccard_k10 MeanJaccard_k75</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; 1           0.9276370      0.9373636       0.1795005       0.4312218</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; 2           0.8687591      0.9013715       0.1119028       0.3321728</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; 3           0.8727020      0.8910880       0.1308071       0.3423275</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; 4           0.8185515      0.8150897       0.1248989       0.2972574</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; 5           0.8689056      0.8783589       0.1306221       0.3414594</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; 6           0.8776535      0.8933198       0.1357447       0.3552548</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; 7           0.8769331      0.8897828       0.1221807       0.3429811</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; 8           0.8747509      0.8911844       0.1200613       0.3452937</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt;   coRankingQlocal coRankingQglobal KmaxLCMC</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; 1       0.3878417        0.2506657      122</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; 2       0.2809464        0.2013317      125</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt; 3       0.2974784        0.1879825      123</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt; 4       0.2373592        0.1246741       99</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt; 5       0.2872996        0.1736344      115</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt; 6       0.3075334        0.1929842      123</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt; 7       0.2929861        0.1766472      124</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt; 8       0.2865258        0.1935466      116</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>({</a>
<a class="sourceLine" id="cb4-39" data-line-number="39">  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb4-40" data-line-number="40">})</a>
<a class="sourceLine" id="cb4-41" data-line-number="41">cowplot<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(dre<span class="op">$</span>plots<span class="op">$</span>disthex, <span class="cf">function</span>(w) w <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.title =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size =</span> <span class="dv">7</span>))), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="dreval_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/plotRankSummary.html">plotRankSummary</a></span>(dre<span class="op">$</span>scores) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="dreval_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
</div>
<div id="using-a-reduced-dimension-representation-as-the-reference-space" class="section level1">
<h1 class="hasAnchor">
<a href="#using-a-reduced-dimension-representation-as-the-reference-space" class="anchor"></a>Using a reduced dimension representation as the reference space</h1>
<p>In the example above, we used the original feature space (the <code>logcounts</code> assay) as the reference space, to which all reduced dimension representations were compared. It is also possible to use one of the reduced dimension representations as the reference space, as we will illustrate here.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">dre &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dreval.html">dreval</a></span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="dt">sce =</span> pbmc3ksub, <span class="dt">refType =</span> <span class="st">"dimred"</span>, <span class="dt">refDimRed =</span> <span class="st">"PCA"</span>, </a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dt">dimReds =</span> <span class="ot">NULL</span>, <span class="dt">nSamples =</span> <span class="dv">500</span>, <span class="dt">kTM =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">10</span>, <span class="dv">75</span>), </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">distNorm =</span> <span class="st">"l2"</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">)</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">dre<span class="op">$</span>scores</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt;         Method dimensionality SpearmanCorrDist PearsonCorrDist KSStatDist</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; 1       PCA_k2              2        0.9270669       0.9214124 0.28690180</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; 2  TSNE_perp30              2        0.7899467       0.7802474 0.13724248</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; 3   TSNE_perp5              2        0.5870023       0.5791931 0.09672946</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; 4  TSNE_perp15              2        0.7453701       0.7375564 0.11903808</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; 5 TSNE_perp100              2        0.7959204       0.7963781 0.22461723</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; 6    UMAP_nn15              2        0.8062863       0.8139860 0.31801202</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; 7    UMAP_nn30              2        0.8541121       0.8236528 0.37096593</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;   EuclDistBetweenDists SammonStress Trustworthiness_k10 Continuity_k10</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; 1            0.2945478   0.11943608           0.9145247      0.9436417</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; 2            0.2864810   0.09600093           0.9600949      0.9617036</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; 3            0.3656042   0.14727530           0.9412277      0.9386989</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; 4            0.3020488   0.10426895           0.9557465      0.9570696</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; 5            0.3176252   0.12532810           0.9627930      0.9673763</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; 6            0.3652610   0.17779620           0.9549432      0.9601313</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; 7            0.3968041   0.21257127           0.9544025      0.9632157</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt;   Trustworthiness_k75 Continuity_k75 MeanJaccard_k10 MeanJaccard_k75</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; 1           0.9386936      0.9549083       0.1738989       0.4799105</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; 2           0.9405501      0.9502324       0.3182643       0.5504494</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; 3           0.8836361      0.9077632       0.2705294       0.4611198</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; 4           0.9326467      0.9446135       0.3029767       0.5369534</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; 5           0.9520194      0.9581437       0.3428362       0.5823731</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; 6           0.9470050      0.9549803       0.3006850       0.5551565</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; 7           0.9487873      0.9574412       0.2934701       0.5618351</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt;   coRankingQlocal coRankingQglobal KmaxLCMC</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; 1       0.4237190        0.2714678      132</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; 2       0.4895806        0.2646581       62</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt; 3       0.4141499        0.1953064       61</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt; 4       0.4708637        0.2505102       62</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt; 5       0.5127336        0.2790235       62</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt; 6       0.4728111        0.2685399       61</span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt; 7       0.4768815        0.2856778       62</span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34">cowplot<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(dre<span class="op">$</span>plots<span class="op">$</span>disthex, <span class="cf">function</span>(w) w <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.title =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size =</span> <span class="dv">7</span>))), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="dreval_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/plotRankSummary.html">plotRankSummary</a></span>(dre<span class="op">$</span>scores) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="dreval_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div id="computational-efficiency" class="section level1">
<h1 class="hasAnchor">
<a href="#computational-efficiency" class="anchor"></a>Computational efficiency</h1>
<p><code>dreval</code> relies heavily on the calculation of pairwise distances among samples, and is consequently computationally demanding for large data sets. The <code><a href="../reference/dreval.html">dreval()</a></code> function allows for subsampling a smaller number of samples, as well as selecting a subset of the variables, to speed up calculations and reduce the memory footprint. Here we illustrate that for the example data set, the calculated metrics are stable under subsampling of cells.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>({</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">})</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">nS &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">100</span>, <span class="dv">400</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">2700</span>)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">v &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(nS, <span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  <span class="cf">if</span> (n <span class="op">==</span><span class="st"> </span><span class="dv">2700</span>) nR &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">  <span class="cf">else</span> nR &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">  <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(nR), <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">    <span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(n, <span class="st">" samples, replicate "</span>, i)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">    <span class="kw"><a href="../reference/dreval.html">dreval</a></span>(<span class="dt">sce =</span> pbmc3ksub, <span class="dt">refAssay =</span> <span class="st">"logcounts"</span>, <span class="dt">dimReds =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">           <span class="dt">nSamples =</span> n, <span class="dt">kTM =</span> <span class="dv">50</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)<span class="op">$</span>scores <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">nSamples =</span> n, <span class="dt">replicate =</span> i)</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">  })</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">})</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">vv &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(dplyr<span class="op">::</span>bind_rows, v)</a>
<a class="sourceLine" id="cb9-20" data-line-number="20"></a>
<a class="sourceLine" id="cb9-21" data-line-number="21">vv &lt;-<span class="st"> </span>vv <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(</a>
<a class="sourceLine" id="cb9-23" data-line-number="23">    <span class="dt">key =</span> <span class="st">"measure"</span>, <span class="dt">value =</span> <span class="st">"value"</span>, </a>
<a class="sourceLine" id="cb9-24" data-line-number="24">    <span class="op">-</span>Method, <span class="op">-</span>dimensionality, <span class="op">-</span>nSamples, <span class="op">-</span>replicate</a>
<a class="sourceLine" id="cb9-25" data-line-number="25">  )</a>
<a class="sourceLine" id="cb9-26" data-line-number="26"></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="kw"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(</a>
<a class="sourceLine" id="cb9-28" data-line-number="28">  <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(vv, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> nSamples, <span class="dt">y =</span> value, <span class="dt">color =</span> Method)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span><span class="st"> </span>measure, <span class="dt">scales =</span> <span class="st">"free_y"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a>
<a class="sourceLine" id="cb9-31" data-line-number="31">)</a></code></pre></div>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; R version 3.6.1 (2017-01-27)</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; Running under: Ubuntu 16.04.6 LTS</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; Matrix products: default</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; BLAS:   /home/travis/R-bin/lib/R/lib/libRblas.so</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; locale:</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; attached base packages:</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; other attached packages:</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; [1] ggplot2_3.2.1 dreval_0.1.2 </span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; loaded via a namespace (and not attached):</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt;  [1] Rcpp_1.0.2                  lattice_0.20-38            </span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt;  [3] tidyr_1.0.0                 assertthat_0.2.1           </span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt;  [5] zeallot_0.1.0               rprojroot_1.3-2            </span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt;  [7] digest_0.6.21               SingleCellExperiment_1.7.11</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt;  [9] wordspace_0.2-5             R6_2.4.0                   </span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt; [11] GenomeInfoDb_1.21.2         backports_1.1.5            </span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; [13] sparsesvd_0.2               stats4_3.6.1               </span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; [15] evaluate_0.14               pillar_1.4.2               </span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; [17] coRanking_0.1.4             zlibbioc_1.31.0            </span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; [19] rlang_0.4.0                 lazyeval_0.2.2             </span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; [21] hexbin_1.27.3               S4Vectors_0.23.25          </span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; [23] Matrix_1.2-17               rmarkdown_1.16             </span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt; [25] pkgdown_1.4.1               labeling_0.3               </span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#&gt; [27] desc_1.2.0                  BiocParallel_1.19.3        </span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; [29] stringr_1.4.0               RCurl_1.95-4.12            </span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; [31] munsell_0.5.0               DelayedArray_0.11.8        </span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co">#&gt; [33] compiler_3.6.1              xfun_0.10                  </span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">#&gt; [35] pkgconfig_2.0.3             BiocGenerics_0.31.6        </span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co">#&gt; [37] htmltools_0.4.0             tidyselect_0.2.5           </span></a>
<a class="sourceLine" id="cb10-44" data-line-number="44"><span class="co">#&gt; [39] SummarizedExperiment_1.15.9 tibble_2.1.3               </span></a>
<a class="sourceLine" id="cb10-45" data-line-number="45"><span class="co">#&gt; [41] GenomeInfoDbData_1.2.1      IRanges_2.19.16            </span></a>
<a class="sourceLine" id="cb10-46" data-line-number="46"><span class="co">#&gt; [43] matrixStats_0.55.0          crayon_1.3.4               </span></a>
<a class="sourceLine" id="cb10-47" data-line-number="47"><span class="co">#&gt; [45] dplyr_0.8.3                 withr_2.1.2                </span></a>
<a class="sourceLine" id="cb10-48" data-line-number="48"><span class="co">#&gt; [47] MASS_7.3-51.4               bitops_1.0-6               </span></a>
<a class="sourceLine" id="cb10-49" data-line-number="49"><span class="co">#&gt; [49] grid_3.6.1                  gtable_0.3.0               </span></a>
<a class="sourceLine" id="cb10-50" data-line-number="50"><span class="co">#&gt; [51] lifecycle_0.1.0             magrittr_1.5               </span></a>
<a class="sourceLine" id="cb10-51" data-line-number="51"><span class="co">#&gt; [53] scales_1.0.0                stringi_1.4.3              </span></a>
<a class="sourceLine" id="cb10-52" data-line-number="52"><span class="co">#&gt; [55] XVector_0.25.0              fs_1.3.1                   </span></a>
<a class="sourceLine" id="cb10-53" data-line-number="53"><span class="co">#&gt; [57] ellipsis_0.3.0              vctrs_0.2.0                </span></a>
<a class="sourceLine" id="cb10-54" data-line-number="54"><span class="co">#&gt; [59] cowplot_1.0.0               tools_3.6.1                </span></a>
<a class="sourceLine" id="cb10-55" data-line-number="55"><span class="co">#&gt; [61] iotools_0.2-5               Biobase_2.45.1             </span></a>
<a class="sourceLine" id="cb10-56" data-line-number="56"><span class="co">#&gt; [63] glue_1.3.1                  purrr_0.3.2                </span></a>
<a class="sourceLine" id="cb10-57" data-line-number="57"><span class="co">#&gt; [65] parallel_3.6.1              yaml_2.2.0                 </span></a>
<a class="sourceLine" id="cb10-58" data-line-number="58"><span class="co">#&gt; [67] colorspace_1.4-1            cluster_2.1.0              </span></a>
<a class="sourceLine" id="cb10-59" data-line-number="59"><span class="co">#&gt; [69] GenomicRanges_1.37.16       memoise_1.1.0              </span></a>
<a class="sourceLine" id="cb10-60" data-line-number="60"><span class="co">#&gt; [71] knitr_1.25</span></a></code></pre></div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#evaluation">Evaluation</a></li>
      <li><a href="#result-visualization">Result visualization</a></li>
      <li><a href="#using-a-reduced-dimension-representation-as-the-reference-space">Using a reduced dimension representation as the reference space</a></li>
      <li><a href="#computational-efficiency">Computational efficiency</a></li>
      <li><a href="#session-info">Session info</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://csoneson.github.io">Charlotte Soneson</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
